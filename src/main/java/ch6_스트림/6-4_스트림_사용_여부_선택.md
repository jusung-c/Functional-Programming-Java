## 스트림 사용 여부 선택
모든 데이터 처리가 스트림 파이프라인으로 처리된다고 다 좋은 게 아니다. 스트림 사용 여부를 결정할 때에는 서로 연관된 여러 요소를 고려해야 한다.

---

### 작업의 복잡도는 얼마나 높은가?
단순하게 몇 줄로 이루어진 반복문을 스트림으로 변환했을 때 큰 장점을 얻기는 어렵다. 
간단한 경우라면 for-each를, 복잡한 로직을 가진 긴 루프라면 스트림 파이프라인으로 압축해 처리하자.

### 처리되는 요소의 수는 어느 정도인가?
스트림 파이프라인 구성에 필요한 오버헤드는 처리하는 요소의 수에 비례해 감소한다. 소규모 데이터 소스의 경우 필요한 인스턴스, 메서드 호출, 스택 프레임 및 메모리 사용량 간의 관계는 많은 양의 요소를 처리할 때보다 무시할 수 없을 정도로 중요하다.

순수한 성능으로만 보면 최적화된 for-loop는 순차 스트림에 비해 더 우수하다. 특히 작은 루프에 대해 JVM이 최적화할 수 있는 가능성이 더 많다. 반면, 스트림은 일반적인 자바 타입으로 구현되므로 런타임 오버헤드가 불가피하게 발생한다.

하지만, 스트림의 실행이 최적화되어있지 않다는 뜻은 아니고, 연산을 짧게 만들거나 병합하면서 파이프라인의 처리량을 극대화할 수 있다.

단순히 성능이 스트림보다 for-loop가 조금 더 낫다고 해서 스트림을 선택하지 않을 이유는 없다. 언제든지 코드는 성능 향상의 여지가 있으며 조기 최적화는 모든 악의 근원이 될 수 있다. 약 97%의 대다수 상황에서 단순한 성능에 크게 연연해 할 필요가 없다. 스트림 API가 제공하는 수많은 장점을 고려하면 가장 좋은 해결책이 될 수 있다. 또한 병렬 스트림을 활용해 성능을 최적화할 수도 있다.
